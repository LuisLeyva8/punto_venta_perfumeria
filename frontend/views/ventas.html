<link rel="stylesheet" href="./css/ventas.css" />
<link rel="stylesheet" href="/frontend/css/ventas.css"/>
<section class="ventas-panel">
  <h2 id="titulo-ticket">VENTA DE PRODUCTOS - Ticket 1</h2>

  <div id="ticket-tabs" style="margin-bottom: 10px;">
    <button onclick="addTicket()">+ Nuevo Ticket</button>
  </div>

  <div class="entrada-producto">
    <label for="codigo">Código del Producto:</label>
    <input type="text" id="codigo" placeholder="Escanea o escribe el código...">
    <button id="agregarProducto" onclick="">ENTER - Agregar Producto</button>
  </div>

  <div class="acciones-venta">
    <button onclick="abrirModalINS()">INS Varios</button>
    <button onclick="abrirModalComun()">CTRL+P Art. Común</button>
    <button onclick="abrirModalBuscar()">F10 Buscar</button>
    <button onclick="aplicarMayoreo()">F11 Mayoreo</button>
    <button onclick="abrirModalCaja('entrada')">F7 Entradas</button>
    <button onclick="abrirModalCaja('salida')">F8 Salidas</button>
    <button class="eliminar" onclick="eliminarArticuloSeleccionado()">DEL Borrar Art.</button>
  </div>

  <div class="tabla-productos">
    <table>
      <thead>
        <tr>
          <th>Código de Barras</th>
          <th>Descripción del Producto</th>
          <th>Precio Venta</th>
          <th>Cant.</th>
          <th>Importe</th>
          <th>Existencia</th>
        </tr>
      </thead>
      <tbody id="lista-venta">
        <!-- Las filas de productos se agregan aquí -->
      </tbody>
      </table>
      
      <div id="mensajeVacio" style="display: none; text-align: center; margin-top: 10px; font-style: italic; color: gray;">
        No hay productos agregados todavía.
      </div>
      
    </table>
  </div>

  <div class="resumen-venta">
    <p><strong>0</strong> Productos en la venta actual.</p>
    <div class="acciones-finales">
      <button>F5 - Cambiar</button>
      <button>F6 - Pendiente</button>
      <button class="eliminar">Eliminar</button>
    </div>
    <div class="totales">
      <div>Total: <strong id="total">$0.00</strong></div>
      <div>Pagó Con: <input type="number" id="pago" placeholder="$0.00"></div>
      <div>Cambio: <strong id="cambio">$0.00</strong></div>
    </div>
    <div class="acciones-cobro">
      <button class="btn-cobrar">F12 - Cobrar</button>
      <div class="total-final"><span id="gran-total">$0.00</span></div>
    </div>
    <div class="extras">
      <button>Reimprimir Ultimo Ticket</button>
      <button>Ventas del día y Devoluciones</button>
    </div>
  </div>
</section>

<!-- Modal Entrada/Salida -->
<div id="modalCaja" class="modal">
  <div class="modal-content">
    <h2 id="tituloModalCaja">Movimiento de Caja</h2>
    <p id="dineroActualCaja">Dinero actual en caja: $0.00</p>
    <input type="number" id="cantidadCaja" placeholder="Cantidad" min="0.01" step="0.01">
    <div class="modal-buttons">
      <button onclick="confirmarMovimientoCaja()">Confirmar</button>
      <button onclick="cerrarModalCaja()">Cancelar</button>
    </div>
    <p id="mensajeCaja" style="color:red;"></p>
  </div>
</div>

<!-- Modal INS Varios -->
<div id="modalINS" class="modal">
  <div class="modal-content">
    <h2>Agregar Producto Manualmente</h2>
    <input type="text" id="codigoINS" placeholder="Código del producto">
    <input type="number" id="cantidadINS" placeholder="Cantidad" min="1" value="1">
    <div class="modal-buttons">
      <button onclick="confirmarINS()">Agregar</button>
      <button onclick="cerrarModalINS()">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal Producto Común -->
<div id="modalComun" class="modal">
  <div class="modal-content">
    <h2>Agregar Producto Común</h2>
    <input type="text" id="descripcionComun" placeholder="Descripción del producto" />
    <input type="number" id="cantidadComun" placeholder="Cantidad" min="1" value="1" />
    <input type="number" id="precioComun" placeholder="Precio" min="0" step="0.01" value="0.00" />
    <div class="modal-buttons">
      <button onclick="confirmarComun()">Aceptar</button>
      <button onclick="cerrarModalComun()">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal Buscar Producto -->
<div id="modalBuscar" class="modal">
  <div class="modal-content" style="width: 600px; max-height: 80vh; overflow-y: auto;">
    <h2>Buscar Producto</h2>
    <input type="text" id="inputBuscarDescripcion" placeholder="Escribe para buscar..." oninput="buscarProductosPorDescripcion()" style="width: 100%; padding: 8px; margin-bottom: 10px;" />

    <table id="tablaResultadosBuscar" style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th>Descripción del Producto</th>
          <th>Precio Venta</th>
          <th>Departamento</th>
        </tr>
      </thead>
      <tbody>
        <!-- Resultados dinámicos -->
      </tbody>
    </table>

    <div class="modal-buttons" style="margin-top: 15px;">
      <button onclick="aceptarProductoBusqueda()">ENTER - Aceptar</button>
      <button onclick="cerrarModalBuscar()">ESC - Cancelar</button>
    </div>
  </div>
</div>

<script src="/frontend/js/ventas.js" defer></script>